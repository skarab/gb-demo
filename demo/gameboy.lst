                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ANSI-C Compiler
                                      3 ; Version 4.1.0 #12072 (MINGW32)
                                      4 ;--------------------------------------------------------
                                      5 	.module gameboy
                                      6 	.optsdcc -mgbz80
                                      7 	
                                      8 ;--------------------------------------------------------
                                      9 ; Public variables in this module
                                     10 ;--------------------------------------------------------
                                     11 	.globl _vbl_music
                                     12 	.globl _hUGE_dosound
                                     13 	.globl _hUGE_init
                                     14 	.globl _add_VBL
                                     15 	.globl _current_music_bank
                                     16 	.globl _pause_counter
                                     17 	.globl _sintable
                                     18 	.globl _PalFadeCount
                                     19 	.globl _PalFadeBlack
                                     20 	.globl _PalFadeWhite
                                     21 	.globl _PalScrollCount
                                     22 	.globl _PalScroll
                                     23 	.globl _set_palette
                                     24 	.globl _set_default_palette
                                     25 	.globl _play_music
                                     26 	.globl _abs
                                     27 	.globl _mod
                                     28 ;--------------------------------------------------------
                                     29 ; special function registers
                                     30 ;--------------------------------------------------------
                                     31 ;--------------------------------------------------------
                                     32 ; ram data
                                     33 ;--------------------------------------------------------
                                     34 	.area _DATA
      000000                         35 _pause_counter::
      000000                         36 	.ds 2
      000002                         37 _current_music_bank::
      000002                         38 	.ds 1
      000003                         39 _vbl_music___save_65536_111:
      000003                         40 	.ds 1
      000004                         41 _play_music_vbl_done_65536_113:
      000004                         42 	.ds 2
                                     43 ;--------------------------------------------------------
                                     44 ; absolute external ram data
                                     45 ;--------------------------------------------------------
                                     46 	.area _DABS (ABS)
                                     47 ;--------------------------------------------------------
                                     48 ; global & static initialisations
                                     49 ;--------------------------------------------------------
                                     50 	.area _HOME
                                     51 	.area _GSINIT
                                     52 	.area _GSFINAL
                                     53 	.area _GSINIT
                                     54 ;src\gameboy.c:55: static int vbl_done = 0;
      000000 21r04r00                55 	ld	hl, #_play_music_vbl_done_65536_113
      000003 36 00                   56 	ld	(hl), #0x00
      000005 23                      57 	inc	hl
      000006 36 00                   58 	ld	(hl), #0x00
                                     59 ;--------------------------------------------------------
                                     60 ; Home
                                     61 ;--------------------------------------------------------
                                     62 	.area _HOME
                                     63 	.area _HOME
                                     64 ;--------------------------------------------------------
                                     65 ; code
                                     66 ;--------------------------------------------------------
                                     67 	.area _CODE
                                     68 ;src\gameboy.c:29: inline void set_palette(unsigned int palette)
                                     69 ;	---------------------------------
                                     70 ; Function set_palette
                                     71 ; ---------------------------------
      000000                         72 _set_palette::
                                     73 ;src\gameboy.c:31: BGP_REG = palette;
      000000 F8 02                   74 	ldhl	sp,	#2
      000002 7E                      75 	ld	a, (hl)
      000003 E0r00                   76 	ldh	(_BGP_REG+0),a
                                     77 ;src\gameboy.c:32: }
      000005 C9                      78 	ret
      000006                         79 _PalScroll:
      000006 E4 00                   80 	.dw #0x00e4
      000008 C9 00                   81 	.dw #0x00c9
      00000A D2 00                   82 	.dw #0x00d2
      00000C                         83 _PalScrollCount:
      00000C 03 00                   84 	.dw #0x0003
      00000E                         85 _PalFadeWhite:
      00000E E4 00                   86 	.dw #0x00e4
      000010 90 00                   87 	.dw #0x0090
      000012 40 00                   88 	.dw #0x0040
      000014 00 00                   89 	.dw #0x0000
      000016                         90 _PalFadeBlack:
      000016 E4 00                   91 	.dw #0x00e4
      000018 F9 00                   92 	.dw #0x00f9
      00001A FE 00                   93 	.dw #0x00fe
      00001C FF 00                   94 	.dw #0x00ff
      00001E                         95 _PalFadeCount:
      00001E 04 00                   96 	.dw #0x0004
      000020                         97 _sintable:
      000020 80                      98 	.db #0x80	; 128
      000021 85                      99 	.db #0x85	; 133
      000022 8B                     100 	.db #0x8b	; 139
      000023 90                     101 	.db #0x90	; 144
      000024 96                     102 	.db #0x96	; 150
      000025 9B                     103 	.db #0x9b	; 155
      000026 A0                     104 	.db #0xa0	; 160
      000027 A6                     105 	.db #0xa6	; 166
      000028 AB                     106 	.db #0xab	; 171
      000029 B0                     107 	.db #0xb0	; 176
      00002A B5                     108 	.db #0xb5	; 181
      00002B BA                     109 	.db #0xba	; 186
      00002C BF                     110 	.db #0xbf	; 191
      00002D C4                     111 	.db #0xc4	; 196
      00002E C9                     112 	.db #0xc9	; 201
      00002F CD                     113 	.db #0xcd	; 205
      000030 D1                     114 	.db #0xd1	; 209
      000031 D6                     115 	.db #0xd6	; 214
      000032 DA                     116 	.db #0xda	; 218
      000033 DE                     117 	.db #0xde	; 222
      000034 E1                     118 	.db #0xe1	; 225
      000035 E5                     119 	.db #0xe5	; 229
      000036 E8                     120 	.db #0xe8	; 232
      000037 EB                     121 	.db #0xeb	; 235
      000038 EE                     122 	.db #0xee	; 238
      000039 F1                     123 	.db #0xf1	; 241
      00003A F3                     124 	.db #0xf3	; 243
      00003B F5                     125 	.db #0xf5	; 245
      00003C F7                     126 	.db #0xf7	; 247
      00003D F9                     127 	.db #0xf9	; 249
      00003E FB                     128 	.db #0xfb	; 251
      00003F FC                     129 	.db #0xfc	; 252
      000040 FD                     130 	.db #0xfd	; 253
      000041 FE                     131 	.db #0xfe	; 254
      000042 FF                     132 	.db #0xff	; 255
      000043 FF                     133 	.db #0xff	; 255
      000044 FF                     134 	.db #0xff	; 255
      000045 FF                     135 	.db #0xff	; 255
      000046 FF                     136 	.db #0xff	; 255
      000047 FE                     137 	.db #0xfe	; 254
      000048 FD                     138 	.db #0xfd	; 253
      000049 FC                     139 	.db #0xfc	; 252
      00004A FB                     140 	.db #0xfb	; 251
      00004B F9                     141 	.db #0xf9	; 249
      00004C F7                     142 	.db #0xf7	; 247
      00004D F5                     143 	.db #0xf5	; 245
      00004E F3                     144 	.db #0xf3	; 243
      00004F F1                     145 	.db #0xf1	; 241
      000050 EE                     146 	.db #0xee	; 238
      000051 EB                     147 	.db #0xeb	; 235
      000052 E8                     148 	.db #0xe8	; 232
      000053 E5                     149 	.db #0xe5	; 229
      000054 E1                     150 	.db #0xe1	; 225
      000055 DE                     151 	.db #0xde	; 222
      000056 DA                     152 	.db #0xda	; 218
      000057 D6                     153 	.db #0xd6	; 214
      000058 D1                     154 	.db #0xd1	; 209
      000059 CD                     155 	.db #0xcd	; 205
      00005A C9                     156 	.db #0xc9	; 201
      00005B C4                     157 	.db #0xc4	; 196
      00005C BF                     158 	.db #0xbf	; 191
      00005D BA                     159 	.db #0xba	; 186
      00005E B5                     160 	.db #0xb5	; 181
      00005F B0                     161 	.db #0xb0	; 176
      000060 AB                     162 	.db #0xab	; 171
      000061 A6                     163 	.db #0xa6	; 166
      000062 A0                     164 	.db #0xa0	; 160
      000063 9B                     165 	.db #0x9b	; 155
      000064 96                     166 	.db #0x96	; 150
      000065 90                     167 	.db #0x90	; 144
      000066 8B                     168 	.db #0x8b	; 139
      000067 85                     169 	.db #0x85	; 133
      000068 80                     170 	.db #0x80	; 128
      000069 7A                     171 	.db #0x7a	; 122	'z'
      00006A 74                     172 	.db #0x74	; 116	't'
      00006B 6F                     173 	.db #0x6f	; 111	'o'
      00006C 69                     174 	.db #0x69	; 105	'i'
      00006D 64                     175 	.db #0x64	; 100	'd'
      00006E 5F                     176 	.db #0x5f	; 95
      00006F 59                     177 	.db #0x59	; 89	'Y'
      000070 54                     178 	.db #0x54	; 84	'T'
      000071 4F                     179 	.db #0x4f	; 79	'O'
      000072 4A                     180 	.db #0x4a	; 74	'J'
      000073 45                     181 	.db #0x45	; 69	'E'
      000074 40                     182 	.db #0x40	; 64
      000075 3B                     183 	.db #0x3b	; 59
      000076 36                     184 	.db #0x36	; 54	'6'
      000077 32                     185 	.db #0x32	; 50	'2'
      000078 2E                     186 	.db #0x2e	; 46
      000079 29                     187 	.db #0x29	; 41
      00007A 25                     188 	.db #0x25	; 37
      00007B 21                     189 	.db #0x21	; 33
      00007C 1E                     190 	.db #0x1e	; 30
      00007D 1A                     191 	.db #0x1a	; 26
      00007E 17                     192 	.db #0x17	; 23
      00007F 14                     193 	.db #0x14	; 20
      000080 11                     194 	.db #0x11	; 17
      000081 0E                     195 	.db #0x0e	; 14
      000082 0C                     196 	.db #0x0c	; 12
      000083 0A                     197 	.db #0x0a	; 10
      000084 08                     198 	.db #0x08	; 8
      000085 06                     199 	.db #0x06	; 6
      000086 04                     200 	.db #0x04	; 4
      000087 03                     201 	.db #0x03	; 3
      000088 02                     202 	.db #0x02	; 2
      000089 01                     203 	.db #0x01	; 1
      00008A 00                     204 	.db #0x00	; 0
      00008B 00                     205 	.db #0x00	; 0
      00008C 00                     206 	.db #0x00	; 0
      00008D 00                     207 	.db #0x00	; 0
      00008E 00                     208 	.db #0x00	; 0
      00008F 01                     209 	.db #0x01	; 1
      000090 02                     210 	.db #0x02	; 2
      000091 03                     211 	.db #0x03	; 3
      000092 04                     212 	.db #0x04	; 4
      000093 06                     213 	.db #0x06	; 6
      000094 08                     214 	.db #0x08	; 8
      000095 0A                     215 	.db #0x0a	; 10
      000096 0C                     216 	.db #0x0c	; 12
      000097 0E                     217 	.db #0x0e	; 14
      000098 11                     218 	.db #0x11	; 17
      000099 14                     219 	.db #0x14	; 20
      00009A 17                     220 	.db #0x17	; 23
      00009B 1A                     221 	.db #0x1a	; 26
      00009C 1E                     222 	.db #0x1e	; 30
      00009D 21                     223 	.db #0x21	; 33
      00009E 25                     224 	.db #0x25	; 37
      00009F 29                     225 	.db #0x29	; 41
      0000A0 2E                     226 	.db #0x2e	; 46
      0000A1 32                     227 	.db #0x32	; 50	'2'
      0000A2 36                     228 	.db #0x36	; 54	'6'
      0000A3 3B                     229 	.db #0x3b	; 59
      0000A4 40                     230 	.db #0x40	; 64
      0000A5 45                     231 	.db #0x45	; 69	'E'
      0000A6 4A                     232 	.db #0x4a	; 74	'J'
      0000A7 4F                     233 	.db #0x4f	; 79	'O'
      0000A8 54                     234 	.db #0x54	; 84	'T'
      0000A9 59                     235 	.db #0x59	; 89	'Y'
      0000AA 5F                     236 	.db #0x5f	; 95
      0000AB 64                     237 	.db #0x64	; 100	'd'
      0000AC 69                     238 	.db #0x69	; 105	'i'
      0000AD 6F                     239 	.db #0x6f	; 111	'o'
      0000AE 74                     240 	.db #0x74	; 116	't'
      0000AF 7A                     241 	.db #0x7a	; 122	'z'
      0000B0 00                     242 	.db 0x00
      0000B1 00                     243 	.db 0x00
      0000B2 00                     244 	.db 0x00
      0000B3 00                     245 	.db 0x00
      0000B4 00                     246 	.db 0x00
      0000B5 00                     247 	.db 0x00
      0000B6 00                     248 	.db 0x00
      0000B7 00                     249 	.db 0x00
      0000B8 00                     250 	.db 0x00
      0000B9 00                     251 	.db 0x00
      0000BA 00                     252 	.db 0x00
      0000BB 00                     253 	.db 0x00
      0000BC 00                     254 	.db 0x00
      0000BD 00                     255 	.db 0x00
      0000BE 00                     256 	.db 0x00
      0000BF 00                     257 	.db 0x00
      0000C0 00                     258 	.db 0x00
      0000C1 00                     259 	.db 0x00
      0000C2 00                     260 	.db 0x00
      0000C3 00                     261 	.db 0x00
      0000C4 00                     262 	.db 0x00
      0000C5 00                     263 	.db 0x00
      0000C6 00                     264 	.db 0x00
      0000C7 00                     265 	.db 0x00
      0000C8 00                     266 	.db 0x00
      0000C9 00                     267 	.db 0x00
      0000CA 00                     268 	.db 0x00
      0000CB 00                     269 	.db 0x00
      0000CC 00                     270 	.db 0x00
      0000CD 00                     271 	.db 0x00
      0000CE 00                     272 	.db 0x00
      0000CF 00                     273 	.db 0x00
      0000D0 00                     274 	.db 0x00
      0000D1 00                     275 	.db 0x00
      0000D2 00                     276 	.db 0x00
      0000D3 00                     277 	.db 0x00
      0000D4 00                     278 	.db 0x00
      0000D5 00                     279 	.db 0x00
      0000D6 00                     280 	.db 0x00
      0000D7 00                     281 	.db 0x00
      0000D8 00                     282 	.db 0x00
      0000D9 00                     283 	.db 0x00
      0000DA 00                     284 	.db 0x00
      0000DB 00                     285 	.db 0x00
      0000DC 00                     286 	.db 0x00
      0000DD 00                     287 	.db 0x00
      0000DE 00                     288 	.db 0x00
      0000DF 00                     289 	.db 0x00
      0000E0 00                     290 	.db 0x00
      0000E1 00                     291 	.db 0x00
      0000E2 00                     292 	.db 0x00
      0000E3 00                     293 	.db 0x00
      0000E4 00                     294 	.db 0x00
      0000E5 00                     295 	.db 0x00
      0000E6 00                     296 	.db 0x00
      0000E7 00                     297 	.db 0x00
      0000E8 00                     298 	.db 0x00
      0000E9 00                     299 	.db 0x00
      0000EA 00                     300 	.db 0x00
      0000EB 00                     301 	.db 0x00
      0000EC 00                     302 	.db 0x00
      0000ED 00                     303 	.db 0x00
      0000EE 00                     304 	.db 0x00
      0000EF 00                     305 	.db 0x00
      0000F0 00                     306 	.db 0x00
      0000F1 00                     307 	.db 0x00
      0000F2 00                     308 	.db 0x00
      0000F3 00                     309 	.db 0x00
      0000F4 00                     310 	.db 0x00
      0000F5 00                     311 	.db 0x00
      0000F6 00                     312 	.db 0x00
      0000F7 00                     313 	.db 0x00
      0000F8 00                     314 	.db 0x00
      0000F9 00                     315 	.db 0x00
      0000FA 00                     316 	.db 0x00
      0000FB 00                     317 	.db 0x00
      0000FC 00                     318 	.db 0x00
      0000FD 00                     319 	.db 0x00
      0000FE 00                     320 	.db 0x00
      0000FF 00                     321 	.db 0x00
      000100 00                     322 	.db 0x00
      000101 00                     323 	.db 0x00
      000102 00                     324 	.db 0x00
      000103 00                     325 	.db 0x00
      000104 00                     326 	.db 0x00
      000105 00                     327 	.db 0x00
      000106 00                     328 	.db 0x00
      000107 00                     329 	.db 0x00
      000108 00                     330 	.db 0x00
      000109 00                     331 	.db 0x00
      00010A 00                     332 	.db 0x00
      00010B 00                     333 	.db 0x00
      00010C 00                     334 	.db 0x00
      00010D 00                     335 	.db 0x00
      00010E 00                     336 	.db 0x00
      00010F 00                     337 	.db 0x00
      000110 00                     338 	.db 0x00
      000111 00                     339 	.db 0x00
      000112 00                     340 	.db 0x00
      000113 00                     341 	.db 0x00
      000114 00                     342 	.db 0x00
      000115 00                     343 	.db 0x00
      000116 00                     344 	.db 0x00
      000117 00                     345 	.db 0x00
      000118 00                     346 	.db 0x00
      000119 00                     347 	.db 0x00
      00011A 00                     348 	.db 0x00
      00011B 00                     349 	.db 0x00
      00011C 00                     350 	.db 0x00
      00011D 00                     351 	.db 0x00
      00011E 00                     352 	.db 0x00
      00011F 00                     353 	.db 0x00
                                    354 ;src\gameboy.c:34: inline void set_default_palette()
                                    355 ;	---------------------------------
                                    356 ; Function set_default_palette
                                    357 ; ---------------------------------
      000120                        358 _set_default_palette::
                                    359 ;src\gameboy.c:36: BGP_REG = 0xE4U;
      000120 3E E4                  360 	ld	a, #0xe4
      000122 E0r00                  361 	ldh	(_BGP_REG+0),a
                                    362 ;src\gameboy.c:37: }
      000124 C9                     363 	ret
                                    364 ;src\gameboy.c:44: void vbl_music()
                                    365 ;	---------------------------------
                                    366 ; Function vbl_music
                                    367 ; ---------------------------------
      000125                        368 _vbl_music::
                                    369 ;src\gameboy.c:47: __save = _current_bank;
      000125 F0r00                  370 	ldh	a, (__current_bank+0)
      000127 EAr03r00               371 	ld	(#_vbl_music___save_65536_111),a
                                    372 ;src\gameboy.c:48: SWITCH_ROM_MBC1(current_music_bank);
      00012A 21r02r00               373 	ld	hl, #_current_music_bank
      00012D 7E                     374 	ld	a, (hl)
      00012E E0r00                  375 	ldh	(__current_bank+0),a
      000130 11 00 20               376 	ld	de, #0x2000
      000133 7E                     377 	ld	a, (hl)
      000134 12                     378 	ld	(de), a
                                    379 ;src\gameboy.c:49: hUGE_dosound();
      000135 CDr00r00               380 	call	_hUGE_dosound
                                    381 ;src\gameboy.c:50: SWITCH_ROM_MBC1(__save);
      000138 21r03r00               382 	ld	hl, #_vbl_music___save_65536_111
      00013B 7E                     383 	ld	a, (hl)
      00013C E0r00                  384 	ldh	(__current_bank+0),a
      00013E 11 00 20               385 	ld	de, #0x2000
      000141 7E                     386 	ld	a, (hl)
      000142 12                     387 	ld	(de), a
                                    388 ;src\gameboy.c:51: }
      000143 C9                     389 	ret
                                    390 ;src\gameboy.c:53: void play_music(const hUGESong_t * music, UINT8 music_bank)
                                    391 ;	---------------------------------
                                    392 ; Function play_music
                                    393 ; ---------------------------------
      000144                        394 _play_music::
                                    395 ;src\gameboy.c:66: }
      000144 F3                     396 	di
                                    397 ;src\gameboy.c:57: SWITCH_ROM_MBC1(music_bank);
      000145 F8 04                  398 	ldhl	sp,	#4
      000147 4E                     399 	ld	c, (hl)
      000148 79                     400 	ld	a, c
      000149 E0r00                  401 	ldh	(__current_bank+0),a
      00014B 11 00 20               402 	ld	de, #0x2000
      00014E 7E                     403 	ld	a, (hl)
      00014F 12                     404 	ld	(de), a
                                    405 ;src\gameboy.c:58: hUGE_init(music);
      000150 C5                     406 	push	bc
      000151 2B                     407 	dec	hl
      000152 2B                     408 	dec	hl
      000153 2A                     409 	ld	a, (hl+)
      000154 66                     410 	ld	h, (hl)
      000155 6F                     411 	ld	l, a
      000156 E5                     412 	push	hl
      000157 CDr00r00               413 	call	_hUGE_init
      00015A E8 02                  414 	add	sp, #2
      00015C C1                     415 	pop	bc
                                    416 ;src\gameboy.c:59: current_music_bank = music_bank;
      00015D 21r02r00               417 	ld	hl, #_current_music_bank
      000160 71                     418 	ld	(hl), c
                                    419 ;src\gameboy.c:61: if (vbl_done==0)
      000161 21r05r00               420 	ld	hl, #_play_music_vbl_done_65536_113 + 1
      000164 3A                     421 	ld	a, (hl-)
      000165 B6                     422 	or	a, (hl)
      000166 20 11                  423 	jr	NZ, 00102$
                                    424 ;src\gameboy.c:63: add_VBL(vbl_music);
      000168 21r25r01               425 	ld	hl, #_vbl_music
      00016B E5                     426 	push	hl
      00016C CDr00r00               427 	call	_add_VBL
      00016F E8 02                  428 	add	sp, #2
                                    429 ;src\gameboy.c:64: vbl_done = 1;
      000171 21r04r00               430 	ld	hl, #_play_music_vbl_done_65536_113
      000174 3E 01                  431 	ld	a, #0x01
      000176 22                     432 	ld	(hl+), a
      000177 36 00                  433 	ld	(hl), #0x00
      000179                        434 00102$:
      000179 FB                     435 	ei
                                    436 ;src\gameboy.c:67: }
      00017A C9                     437 	ret
                                    438 ;src\gameboy.c:69: INT8 abs(INT8 a)
                                    439 ;	---------------------------------
                                    440 ; Function abs
                                    441 ; ---------------------------------
      00017B                        442 _abs::
                                    443 ;src\gameboy.c:71: return a<0?-a:a;
      00017B F8 02                  444 	ldhl	sp,	#2
      00017D CB 7E                  445 	bit	7, (hl)
      00017F 28 04                  446 	jr	Z, 00103$
      000181 AF                     447 	xor	a, a
      000182 96                     448 	sub	a, (hl)
      000183 5F                     449 	ld	e, a
      000184 C9                     450 	ret
      000185                        451 00103$:
      000185 F8 02                  452 	ldhl	sp,	#2
      000187 5E                     453 	ld	e, (hl)
                                    454 ;src\gameboy.c:72: }
      000188 C9                     455 	ret
                                    456 ;src\gameboy.c:74: INT8 mod(INT8 a, INT8 b)
                                    457 ;	---------------------------------
                                    458 ; Function mod
                                    459 ; ---------------------------------
      000189                        460 _mod::
                                    461 ;src\gameboy.c:76: INT8 r = a % b;
      000189 F8 03                  462 	ldhl	sp,	#3
      00018B 7E                     463 	ld	a, (hl)
      00018C F5                     464 	push	af
      00018D 33                     465 	inc	sp
      00018E 2B                     466 	dec	hl
      00018F 7E                     467 	ld	a, (hl)
      000190 F5                     468 	push	af
      000191 33                     469 	inc	sp
      000192 CDr00r00               470 	call	__modschar
      000195 E8 02                  471 	add	sp, #2
      000197 4B                     472 	ld	c, e
                                    473 ;src\gameboy.c:77: return r < 0 ? r + b : r;
      000198 CB 79                  474 	bit	7, c
      00019A 28 06                  475 	jr	Z, 00103$
      00019C 79                     476 	ld	a, c
      00019D F8 03                  477 	ldhl	sp,	#3
      00019F 86                     478 	add	a, (hl)
      0001A0 18 01                  479 	jr	00104$
      0001A2                        480 00103$:
      0001A2 79                     481 	ld	a, c
      0001A3                        482 00104$:
      0001A3 5F                     483 	ld	e, a
                                    484 ;src\gameboy.c:78: }
      0001A4 C9                     485 	ret
                                    486 	.area _CODE
                                    487 	.area _CABS (ABS)
